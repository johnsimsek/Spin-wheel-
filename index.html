<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tattoo Of The Day</title>

<style>
body{margin:0;background:#0b0b0f;font-family:Arial;color:#fff;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px;}
.box{width:min(420px,100%);background:#141420;padding:16px;border-radius:16px;box-shadow:0 0 40px rgba(0,0,0,.6);}
h2{text-align:center;margin:8px 0 14px;font-size:26px;}

.imgWrap{border:1px solid #2a2a3a;border-radius:14px;overflow:hidden;background:#0f0f16;aspect-ratio:1/1;position:relative;display:flex;align-items:center;justify-content:center;}
img{width:100%;height:100%;object-fit:contain;display:block;opacity:0;transition:.3s;}
img.show{opacity:1;}

.overlay{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:flex-end;align-items:center;gap:10px;padding:14px;pointer-events:none;}
.btn{pointer-events:auto;border:none;border-radius:12px;padding:12px 14px;font-weight:800;cursor:pointer;width:100%;max-width:260px;box-shadow:0 12px 30px rgba(0,0,0,.45);transition:.25s;position:relative;overflow:hidden;}
#spinBtn{background:#fff;color:#111;}
#spinBtn:disabled{opacity:.6;cursor:not-allowed;}

#bookBtn{display:none;text-decoration:none;text-align:center;color:#111;background:linear-gradient(145deg,#bfbfbf,#8f8f8f,#cfcfcf);border:1px solid #666;letter-spacing:.5px;}
#bookBtn:hover{transform:translateY(-2px) scale(1.03);box-shadow:0 0 10px rgba(255,255,255,.25),0 0 25px rgba(255,255,255,.35),0 15px 40px rgba(0,0,0,.8);border-color:#999;}
#bookBtn::after{content:"";position:absolute;top:-50%;left:-60%;width:40%;height:200%;background:linear-gradient(120deg,transparent,rgba(255,255,255,.5),transparent);transform:rotate(25deg);animation:shine 4s infinite;}
@keyframes shine{0%{left:-60%;}60%{left:140%;}100%{left:140%;}}

.subscribe{margin-top:10px;font-size:12px;color:#bbb;text-align:center;line-height:1.4;}

form{margin-top:10px;}
input{width:100%;padding:12px;border-radius:12px;border:none;font-size:16px;outline:none;}
.kirjaudu{width:100%;padding:12px;border-radius:12px;border:none;margin-top:10px;font-weight:800;background:red;color:#fff;cursor:pointer;}
.kirjaudu:disabled{opacity:.6;cursor:not-allowed;}
.status{margin-top:8px;font-size:12px;color:#bbb;min-height:16px;text-align:center;}

canvas{position:fixed;inset:0;pointer-events:none;z-index:999;}
</style>
</head>

<body>
<canvas id="confetti"></canvas>

<div class="box">
  <h2>üî• Tattoo Of The Day</h2>

  <div class="imgWrap">
    <img id="img" alt="Tattoo">
    <div class="overlay">
      <button id="spinBtn" class="btn" type="button">SPIN</button>

      <a id="bookBtn" class="btn" target="_blank" rel="noreferrer"
        href="https://form.jotform.com/Tattoo_inkyvibestattoo/Ajanvaraus?fbclid=PARlRTSAP5nc9leHRuA2FlbQIxMQBzcnRjBmFwcF9pZA8xMjQwMjQ1NzQyODc0MTQAAaeJWYt19SRUJabHyW8cn5FAtLdSgUxnV78s6aMlFszcakFsiYxeuzap44crrw_aem_KcBzF0S4BQzaCSgtwB9LEQ">
        Varaa Aika Nyt
      </a>
    </div>
  </div>

  <div class="subscribe">
    Tilaa Ink Vibes -tatuointis√§hk√∂postit saadaksesi eksklusiivisia tarjouksia, alennuksia, viimeisimm√§t uutiset ja inspiroivaa sis√§lt√∂√§.
  </div>

  <iframe name="hidden_iframe" style="display:none;"></iframe>

  <form id="phoneForm" method="POST" target="hidden_iframe"
        action="https://script.google.com/macros/s/AKfycbwYEegtNF44clO31rVT0XQJxSmsqr_FwhY6QvdbvF9n2bJUYUrcKp_Izm3y_OUhHFJcUw/exec">
    <input id="phone" name="phone" type="tel" inputmode="tel" autocomplete="tel" value="+358 " required>
    <button id="submitBtn" class="kirjaudu" type="submit">Kirjaudu</button>
    <div id="status" class="status"></div>
  </form>
</div>

<script>
const LOGO="logo1.jpg";
const TOTAL=31;
const tattoos=[...Array(TOTAL)].map((_,i)=>`tattoo${i+1}.jpg`);

const img=document.getElementById("img");
const spinBtn=document.getElementById("spinBtn");
const bookBtn=document.getElementById("bookBtn");

const KEY="tattoo24";
const DAY=24*60*60*1000;

img.src=LOGO;
img.onload=()=>img.classList.add("show");

function setImg(s){img.classList.remove("show");setTimeout(()=>img.src=s,120);}

function loadLock(){
  try{
    const d=JSON.parse(localStorage.getItem(KEY));
    if(!d || Date.now()>d.until) return null;
    if(typeof d.i!=="number" || d.i<0 || d.i>=tattoos.length) return null;
    return d;
  }catch{return null;}
}
function saveLock(i){localStorage.setItem(KEY,JSON.stringify({i,until:Date.now()+DAY}));}

function spinAnim(final){
  spinBtn.disabled=true;
  bookBtn.style.display="none";

  let c=Math.floor(Math.random()*tattoos.length),delay=55;
  (function step(n){
    if(n>28){
      setImg(tattoos[final]);
      confetti(1400);
      spinBtn.disabled=false;
      bookBtn.style.display="block";
      return;
    }
    c=(c+1+Math.floor(Math.random()*3))%tattoos.length;
    img.src=tattoos[c];
    img.classList.add("show");
    delay=Math.round(delay*1.15);
    setTimeout(()=>step(n+1),delay);
  })(0);
}

const locked=loadLock();
if(locked){
  setImg(tattoos[locked.i]);
  bookBtn.style.display="block";
}

spinBtn.onclick=()=>{
  const l=loadLock();
  if(l){
    setImg(tattoos[l.i]);
    bookBtn.style.display="block";
    return;
  }
  const pick=Math.floor(Math.random()*tattoos.length);
  saveLock(pick);
  spinAnim(pick);
};

// Phone submit UI + validation
const form=document.getElementById("phoneForm");
const phoneEl=document.getElementById("phone");
const statusEl=document.getElementById("status");
const submitBtn=document.getElementById("submitBtn");

function normalizePhone(p){ return p.replace(/[^\d+]/g,"").trim(); }
function validFI(p){
  if(!p.startsWith("+358")) return false;
  const rest=p.slice(4);
  return /^\d+$/.test(rest) && rest.length>=7 && rest.length<=12;
}

form.addEventListener("submit",(e)=>{
  const phone = normalizePhone(phoneEl.value);
  phoneEl.value = phone;

  if(!validFI(phone)){
    e.preventDefault();
    statusEl.textContent="Sy√∂t√§ kelvollinen numero: +358401234567";
    return;
  }

  statusEl.textContent="Liityt√§√§n...";
  submitBtn.disabled=true;

  setTimeout(()=>{
    statusEl.textContent="Liitytty ‚úÖ";
    submitBtn.disabled=false;
    phoneEl.value="+358 ";
  }, 1200);
});

// confetti
const c=document.getElementById("confetti"),x=c.getContext("2d");
function rs(){c.width=innerWidth*devicePixelRatio;c.height=innerHeight*devicePixelRatio;x.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);}
window.addEventListener("resize",rs); rs();
function r(a,b){return Math.random()*(b-a)+a;}
function confetti(ms){
  const s=performance.now();
  const p=[...Array(140)].map(()=>({x:r(0,innerWidth),y:r(-20,-10),vx:r(-2,2),vy:r(2,5),sz:r(6,10),rt:r(0,6),vr:r(-.1,.1),c:`hsl(${r(0,360)} 90% 60%)`}));
  (function t(k){
    x.clearRect(0,0,innerWidth,innerHeight);
    p.forEach(o=>{o.vy+=.06;o.x+=o.vx;o.y+=o.vy;o.rt+=o.vr;x.save();x.translate(o.x,o.y);x.rotate(o.rt);x.fillStyle=o.c;x.fillRect(-o.sz/2,-o.sz/2,o.sz,o.sz*.6);x.restore();});
    if(k-s<ms)requestAnimationFrame(t); else x.clearRect(0,0,innerWidth,innerHeight);
  })(performance.now());
}
</script>
</body>
</html>